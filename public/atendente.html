<!-- ... <head> permanece igual ... -->
<body>
  <div class="container">
    <h1>Área do Atendente</h1>
    <link rel="stylesheet" href="css/style.css">

    <button onclick="location.href='index.html'">Voltar para o Início</button>

    <!-- Reservas -->
    <section>
      <h2>Reservas Agendadas</h2>
      <table id="reservas-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Mesa</th>
            <th>Data</th>
            <th>Horário</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- Mesas Disponíveis Hoje -->
    <section>
      <h2>Mesas Disponíveis Hoje</h2>
      <table id="mesas-disponiveis">
        <thead>
          <tr>
            <th>ID</th>
            <th>Capacidade</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- Formulário de Reserva -->
    <section>
      <h2>Criar ou Editar Reserva</h2>
      <form id="reserva-form">
        <input type="hidden" id="reserva-id" />
        <input type="text" id="cliente" placeholder="Nome do cliente" required />
        <input type="number" id="mesa_id" placeholder="ID da mesa" required />
        <input type="date" id="data_reserva" required />
        <input type="time" id="horario_inicio" required />
        <button type="submit">Salvar Reserva</button>
      </form>
    </section>

    <!-- Gerenciar Mesas -->
    <section>
      <h2>Gerenciar Mesas</h2>
      <button onclick="mostrarFormularioMesa()">Criar Mesa</button>

      <table id="mesas-gerenciadas">
        <thead>
          <tr>
            <th>ID</th>
            <th>Capacidade</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <form id="mesa-form">
        <input type="hidden" id="mesa-id" />
        <input type="number" id="capacidade" placeholder="Capacidade" required />
        <button type="submit">Salvar Mesa</button>
      </form>
    </section>
  </div>

  <script>
    const reservasUrl = 'http://localhost:3000/reservas';
    const mesasUrl = 'http://localhost:3000/mesas';

    async function fetchReservas() {
      try {
        const res = await fetch(reservasUrl);
        const data = await res.json();
        const tbody = document.querySelector('#reservas-table tbody');
        tbody.innerHTML = '';

        data.forEach(r => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${r.id}</td>
            <td>${r.cliente}</td>
            <td>${r.mesa_id}</td>
            <td>${r.data_reserva}</td>
            <td>${r.horario_inicio}</td>
            <td class="actions">
              <button onclick="editReserva(${r.id})">Editar</button>
              <button onclick="deleteReserva(${r.id})">Excluir</button>
            </td>
          `;
          tbody.appendChild(tr);
        });
      } catch (error) {
        console.error('Erro ao buscar reservas:', error);
      }
    }

    async function fetchMesasDisponiveis() {
      try {
        const mesasRes = await fetch(mesasUrl);
        const reservasRes = await fetch(reservasUrl);

        const mesas = await mesasRes.json();
        const reservas = await reservasRes.json();

        const hoje = new Date().toISOString().split('T')[0];
        const mesasReservadasHoje = reservas
          .filter(r => r.data_reserva === hoje)
          .map(r => r.mesa_id);

        const tbody = document.querySelector('#mesas-disponiveis tbody');
        tbody.innerHTML = '';

        mesas
          .filter(m => !mesasReservadasHoje.includes(m.id))
          .forEach(m => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${m.id}</td><td>${m.capacidade}</td>`;
            tbody.appendChild(tr);
          });
      } catch (error) {
        console.error('Erro ao buscar mesas disponíveis:', error);
      }
    }

    async function fetchMesasGerenciadas() {
      try {
        const res = await fetch(mesasUrl);
        const mesas = await res.json();
        const tbody = document.querySelector('#mesas-gerenciadas tbody');
        tbody.innerHTML = '';

        mesas.forEach(m => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${m.id}</td>
            <td>${m.capacidade}</td>
            <td>
              <button onclick="editMesa(${m.id})">Editar</button>
              <button onclick="deleteMesa(${m.id})">Excluir</button>
            </td>
          `;
          tbody.appendChild(tr);
        });
      } catch (error) {
        console.error('Erro ao buscar mesas gerenciadas:', error);
      }
    }

    async function editReserva(id) {
      try {
        const res = await fetch(`${reservasUrl}/${id}`);
        if (!res.ok) throw new Error('Reserva não encontrada');
        const r = await res.json();

        document.getElementById('reserva-id').value = r.id;
        document.getElementById('cliente').value = r.cliente;
        document.getElementById('mesa_id').value = r.mesa_id;
        document.getElementById('data_reserva').value = r.data_reserva;
        document.getElementById('horario_inicio').value = r.horario_inicio;
      } catch (error) {
        alert(error.message);
      }
    }

    async function deleteReserva(id) {
      if (!confirm('Excluir esta reserva?')) return;
      try {
        const res = await fetch(`${reservasUrl}/${id}`, { method: 'DELETE' });
        if (!res.ok) throw new Error('Falha ao excluir reserva');
        await fetchReservas();
        await fetchMesasDisponiveis();
      } catch (error) {
        alert(error.message);
      }
    }

    document.getElementById('reserva-form').addEventListener('submit', async e => {
      e.preventDefault();

      const id = document.getElementById('reserva-id').value;
      const data = {
        cliente: document.getElementById('cliente').value,
        mesa_id: parseInt(document.getElementById('mesa_id').value),
        data_reserva: document.getElementById('data_reserva').value,
        horario_inicio: document.getElementById('horario_inicio').value
      };

      try {
        const res = await fetch(`${reservasUrl}${id ? `/${id}` : ''}`, {
          method: id ? 'PUT' : 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        if (!res.ok) throw new Error('Erro ao salvar reserva');

        e.target.reset();
        document.getElementById('reserva-id').value = '';
        await fetchReservas();
        await fetchMesasDisponiveis();
      } catch (error) {
        alert(error.message);
      }
    });

    function mostrarFormularioMesa() {
      const form = document.getElementById('mesa-form');
      form.style.display = form.style.display === 'none' ? 'block' : 'none';
    }

    async function editMesa(id) {
      try {
        const res = await fetch(`${mesasUrl}/${id}`);
        if (!res.ok) throw new Error('Mesa não encontrada');
        const mesa = await res.json();

        document.getElementById('mesa-id').value = mesa.id;
        document.getElementById('capacidade').value = mesa.capacidade;
        document.getElementById('mesa-form').style.display = 'block';
      } catch (error) {
        alert(error.message);
      }
    }

    async function deleteMesa(id) {
      if (!confirm('Deseja excluir esta mesa?')) return;
      try {
        const res = await fetch(`${mesasUrl}/${id}`, { method: 'DELETE' });
        if (!res.ok) throw new Error('Falha ao excluir mesa');
        await fetchMesasGerenciadas();
        await fetchMesasDisponiveis();
      } catch (error) {
        alert(error.message);
      }
    }

    document.getElementById('mesa-form').addEventListener('submit', async e => {
      e.preventDefault();

      const id = document.getElementById('mesa-id').value;
      const mesa = {
        capacidade: parseInt(document.getElementById('capacidade').value)
      };

      try {
        const res = await fetch(`${mesasUrl}${id ? `/${id}` : ''}`, {
          method: id ? 'PUT' : 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(mesa)
        });
        if (!res.ok) throw new Error('Erro ao salvar mesa');

        e.target.reset();
        document.getElementById('mesa-id').value = '';
        document.getElementById('mesa-form').style.display = 'none';
        await fetchMesasGerenciadas();
        await fetchMesasDisponiveis();
      } catch (error) {
        alert(error.message);
      }
    });

    // Inicialização
    fetchReservas();
    fetchMesasDisponiveis();
    fetchMesasGerenciadas();
  </script>
</body>
</html>
